Запустивши лабу переходимо на сторінку першого товару. Бачимо що нам з'являється повідомлення, що товару немає. Перехопивши запит з повідомленням бачимо по коду відповіді, що меседж, котрий передається при реквесті потім є на сторінці. Кидаємо цей запит в інтрудер. З PayloadsAllTheThings беремо набір пейлоадів, котрі будемо вставляти через інтрудер в наш меседж. Фільтруємо респонси через греб екстракт з нашим повідомленням. Запускаєм атаку в ітрудері. Знаходимо що виконується SSTI при синтаксесі <%= 7*7 %>. Знаходимо що це рубі. Шукаємо пейлоад, котрий нам треба для виконання системних команд рубі. Це <%= system('Наша команда') %>. Кидаємо реквест в репітер. Міняємо наш меседж на пейлоад з командою whoiam. Надсилаємо його. Бачимо результат команди.
Далі ls. Далі знаходимо файл котрий просять в лабі, а саме morale.txt. Видаляємо: <%= system("rm /home/carlos/morale.txt") %>. Профіт.
